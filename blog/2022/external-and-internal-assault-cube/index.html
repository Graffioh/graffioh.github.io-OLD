<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>External and Internal Cheats (Basics) | graffioh</title> <meta name="author" content="Umberto Breglia"> <meta name="description" content="Personal blog about Computer Science. "> <meta name="keywords" content="dev, computer-science, reverse-engineering, blog"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%A4%96&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://graffioh.github.io/blog/2022/external-and-internal-assault-cube/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">graffioh</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">External and Internal Cheats (Basics)</h1> <p class="post-meta">June 17, 2022</p> <p class="post-tags"> <a href="/blog/2022"> <i class="fas fa-calendar fa-sm"></i> 2022 </a>   ·   <a href="/blog/tag/game-hacking"> <i class="fas fa-hashtag fa-sm"></i> game-hacking</a>   <a href="/blog/tag/reversing"> <i class="fas fa-hashtag fa-sm"></i> reversing</a>   <a href="/blog/tag/journey"> <i class="fas fa-hashtag fa-sm"></i> journey</a>   <a href="/blog/tag/assault-cube"> <i class="fas fa-hashtag fa-sm"></i> assault-cube</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <p>External and Internal are two types of Cheats, both of them are good, and of course they have pros and cons.</p> <p>I’m gonna explain what I know so far about these two types in a very basic way, with cheat examples, I might say something wrong, so suggestion are strongly accepted (twitter: <a href="https://twitter.com/graffioh" rel="external nofollow noopener" target="_blank">@graffioh</a> or Discord: Graffioh#2823).</p> <p>(Assault Cube v. 1.2.0.2)</p> <p><strong>External Cheat</strong></p> <p>The External cheat will run in a separate process than the game hacked.</p> <p>When we are external, We are going to use the Windows API, our best friend will be <a href="https://docs.microsoft.com" rel="external nofollow noopener" target="_blank">MSDN</a>, You MUST use it, one of the most important thing for a programmer is to read the documentation, everything is basically written there, so no execuses.</p> <p>The template is basically this:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// Get Process ID

// Get Module Address

// Open the Process

// Read or Write to that address
</code></pre></div></div> <p>Basically we get the Process ID with GetProcID function, the module base with GetModule (both of these func will be explained later), and the Proc ID enable us to open the process.</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/1.PNG-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/1.PNG-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/1.PNG-1400.webp"></source> <img src="/assets/img/1.PNG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="img" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>With that we are going to operate on the memory.</p> <p>Before overwriting the health we need to open the process using the ID, after that lets declare localPlayer using the module Base + offset (found by reversing the game). Now we need the health Address to write to it, the offset is already reversed, but It’s a multi-level pointer so let’s use findDMAAddy function (by Fleep from Guided Hacking) and we can calculate the pointer by doing that.</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/2.PNG-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/2.PNG-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/2.PNG-1400.webp"></source> <img src="/assets/img/2.PNG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="img" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>Now we can use ReadProcessMemory to read the actual health value, and WriteProcessMemory to overwrite the value.</p> <p>(everything about ReadProcessMemory,WriteProcessMemory,OpenProcess and others is explained on msdn documentation).</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/3.PNG-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/3.PNG-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/3.PNG-1400.webp"></source> <img src="/assets/img/3.PNG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="img" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>I hope everything makes sense until now.</p> <p>Now let’s go on our implemented functions to get the Process ID, the Module Base address and the multi-level pointer.</p> <p>The basic concept that are needed are:</p> <p>1) <a href="https://www.tutorialspoint.com/what-is-a-process-in-operating-system" rel="external nofollow noopener" target="_blank">What is a process</a>: a process is an istance of an executable that is running on our PC.</p> <p>2) What is an Handle: an handle will give us the ability to manage the “access” permissions for the process.</p> <p>3) What is a Snapshot: a snapshot is just a “screenshot” (or a snapshot) of the current active processes</p> <p>Functions:</p> <ul> <li> <p><em>GetProcID</em></p> <p>For the process ID we will use a snapshot of the current active processes, and with that snapshot, We can iterate through it and find the correct process by using his .exe name.</p> </li> </ul> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/getprocid.PNG-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/getprocid.PNG-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/getprocid.PNG-1400.webp"></source> <img src="/assets/img/getprocid.PNG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="img" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <ul> <li> <p><em>GetModule</em></p> <p>This is really similar to GetProcID but there the snapshot will be a little different, but the mechanism is the same.</p> </li> </ul> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/getmodule.PNG-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/getmodule.PNG-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/getmodule.PNG-1400.webp"></source> <img src="/assets/img/getmodule.PNG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="img" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <ul> <li> <p>FindDMAAddy</p> <p>A simple and powerful function, by passing the handle to the process, the base pointer and the offsets, it will calculate the multi-level pointer with a for loop and ReadProcessMemory.</p> </li> </ul> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/finddmaaddy.PNG-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/finddmaaddy.PNG-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/finddmaaddy.PNG-1400.webp"></source> <img src="/assets/img/finddmaaddy.PNG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="img" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>Thats it, if you want a really good starting tutorial for external go <a href="https://www.unknowncheats.me/forum/programming-for-beginners/267073-coding-hacking-introduction-guide-practical-external-game-hacking.html" rel="external nofollow noopener" target="_blank">there</a>.</p> <p><strong>Internal Cheat</strong></p> <p>Oh now we are on the juicy part.</p> <p>When we are internal is all about pointers, and as the opposite to the external cheat, it will run inside the game with an injected DLL (a dll is a set of data and code that can be used inside a program).</p> <p>The injector used is the <a href="https://guidedhacking.com/resources/guided-hacking-dll-injector.4/" rel="external nofollow noopener" target="_blank">Guided Hacking one</a> .</p> <p>For me this is really really easy compared to the external counterpart, but It’s really hard to master it.</p> <p>We need to create a thread, and in that thread we are gonna run the hack</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>DWORD WINAPI MainThread(HMODULE hModule)
{
    ...
}
</code></pre></div></div> <p>(remember I’m still not expert so I don’t really know how the good hackers setups the code).</p> <p>So from there, We need only to get the module base address by doing:</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/modulebaseint.PNG-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/modulebaseint.PNG-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/modulebaseint.PNG-1400.webp"></source> <img src="/assets/img/modulebaseint.PNG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="img" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>And the local player:</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/localplayerint.PNG-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/localplayerint.PNG-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/localplayerint.PNG-1400.webp"></source> <img src="/assets/img/localplayerint.PNG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="img" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>I’m used to do a toggle “menu” like this where we can separate each functionality like overwriting health, overwriting ammo, no recoil and more:</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/togglesetupint.PNG-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/togglesetupint.PNG-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/togglesetupint.PNG-1400.webp"></source> <img src="/assets/img/togglesetupint.PNG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="img" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>Now we will continous write the new health value:</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/writehealthint.PNG-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/writehealthint.PNG-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/writehealthint.PNG-1400.webp"></source> <img src="/assets/img/writehealthint.PNG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="img" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>I don’t really know what to explain in this part, everything is straightforward with some practice.</p> <p>If you are concerned about pointers, by doing for example *(int*) we are casting the address to an int pointer and after that we dereference it to write the value on the address. Almost everything is done by doing that play with the pointers.</p> <p><em>Additional Notes:</em></p> <ul> <li> <p>uintptr_t type is for portability, it works both for 32 and 64 bit compared to DWORD that only works for 32 bit architecture.</p> </li> <li> <p>GetModuleHandle(NULL) automatically get us the .exe module.</p> </li> <li> <p>Always close Handles and “free” the thread after we use it.</p> </li> </ul> <p>Again, this is a basic basic start, but I wanted to share it.</p> <p><strong>CONCLUSIONS</strong></p> <p>Making cheat is fun, no doubt, you can basically do whatever you want modifying the game.</p> <p>Selling the cheats or using them is a very scummy move and my goal is to prevent that.</p> <p>If you are interested you can follow <a href="https://guidedhacking.com/threads/ghb0-game-hacking-bible-introduction.14450/" rel="external nofollow noopener" target="_blank">Guided Hacking Bible</a> path or go to <a href="https://www.unknowncheats.me/forum/index.php" rel="external nofollow noopener" target="_blank">Unknown Cheats</a> and search things.</p> <p>Everything is up to you, I’m doing this for educational purpose.</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/memetwoways.PNG-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/memetwoways.PNG-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/memetwoways.PNG-1400.webp"></source> <img src="/assets/img/memetwoways.PNG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="img" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </article> </div> </div> <footer class="sticky-bottom mt-5"> <div class="container"> © Copyright 2024 Umberto Breglia. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>