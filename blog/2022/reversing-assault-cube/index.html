<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Reversing Assault Cube (v1.2.0.2) | graffioh</title> <meta name="author" content="Umberto Breglia"> <meta name="description" content="Personal blog about Computer Science. "> <meta name="keywords" content="dev, computer-science, reverse-engineering, blog"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%A4%96&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://graffioh.github.io/blog/2022/reversing-assault-cube/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/">graffioh</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Reversing Assault Cube (v1.2.0.2)</h1> <p class="post-meta">June 9, 2022</p> <p class="post-tags"> <a href="/blog/2022"> <i class="fas fa-calendar fa-sm"></i> 2022 </a>   ·   <a href="/blog/tag/game-hacking"> <i class="fas fa-hashtag fa-sm"></i> game-hacking</a>   <a href="/blog/tag/reversing"> <i class="fas fa-hashtag fa-sm"></i> reversing</a>   <a href="/blog/tag/journey"> <i class="fas fa-hashtag fa-sm"></i> journey</a>   <a href="/blog/tag/assault-cube"> <i class="fas fa-hashtag fa-sm"></i> assault-cube</a>   </p> </header> <article class="post-content"> <div id="markdown-content"> <p>Assault Cube is an open source FPS game, now it’s outdated, but for practicing game hacking is really good, because the reversing part is easy (except maybe for some functions).</p> <p>When reversing a game, We don’t mind if the cheat is gonna be External or Internal (maybe I will do a post explaining it based on my knowledge in the future), both of them have pros and cons, and both of them are really similar when we talk about coding the cheat.</p> <p>Assault Cube cheat table (for Cheat Engine):</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/assaultcubeCT.PNG-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/assaultcubeCT.PNG-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/assaultcubeCT.PNG-1400.webp"></source> <img src="/assets/img/assaultcubeCT.PNG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="img" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>The goal is to get a cheat table like that, it’s not complete, but you can do a lot of things with these pointers and offsets.</p> <p>Remember, there are more ways to get the same result, even in reversing.</p> <p>I will try to explain how to get some good pointers/offsets to work with but I will not go too in depth, as there are a lot of good resources online like <a href="https://guidedhacking.com/" rel="external nofollow noopener" target="_blank">Guided Hacking</a> and <a href="https://www.unknowncheats.me/forum/index.php" rel="external nofollow noopener" target="_blank">Unknown Cheats</a>.</p> <h2 id="from-beginner-to-advanced">From beginner to advanced:</h2> <p>1) <strong>BEGINNER</strong> (Local player and Health):</p> <p>The basic way is through Cheat Engine and “find out what accesses this address”, but there are other ways for example with REClass.Net.</p> <p>We gonna start with a basic scan for the health, using granades and decreasing our health, by doing that and after some hits we will find something like this:</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/scanhealth1-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/scanhealth1-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/scanhealth1-1400.webp"></source> <img src="/assets/img/scanhealth1.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="img" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>Now we need a pointer to that otherwise everytime We restart the game, that address is gonna change, and we’ll need to do this process again.</p> <p>To find a pointer do a pointer scan with pointermaps or as you want.</p> <p>Now that we have a pointer, We have the offset too (in our case 0xF8), and with It We can finally modify our health with our cheat.</p> <p>Through health you can find the local player too.</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/examplehealth1-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/examplehealth1-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/examplehealth1-1400.webp"></source> <img src="/assets/img/examplehealth1.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="img" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>With the local player + offsets we can basically access every properties of that particular class.</p> <p>2) <strong>INTERMEDIATE</strong> (Current ammo and Weapon Damage):</p> <p>We gonna use REClass.Net, a powerful tool to find offsets based on local player (in this case).</p> <p>Before REClass just scan your ammo that you see for your current weapon type, for example rifle ammo and after that you will find the pointer.</p> <p>Now that we have the rifle ammo ptr, We can find the current weapon offset by reversing with “Multi-level pointer base calculation”.</p> <p>For reference the calculation is like this (took this formula from Guided Hacking):</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Address = Value = ?
base ptr -&gt; address + offset 4 = address
base ptr -&gt; address + offset 3 = address
base ptr -&gt; address + offset 2 = address
static base -&gt; address + offset 1 = address
</code></pre></div></div> <p>And with some scans we have this:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>00FCA190 = Value = 20
00FCA474 -&gt; 00FCA190 + 0 = 00FCA190
00FCA3B4 -&gt; 00FCA460 + 14 = 00FCA474
ac_client.exe+10F4F4 -&gt; 00FCA040 + 374 
</code></pre></div></div> <p>So the current Weapon offset is 374.</p> <p>We still have to find the weapon damage, and we will do it with REClass, it will look like this:</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/weaponDmg1.PNG-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/weaponDmg1.PNG-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/weaponDmg1.PNG-1400.webp"></source> <img src="/assets/img/weaponDmg1.PNG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="img" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/weaponDmg2.PNG-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/weaponDmg2.PNG-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/weaponDmg2.PNG-1400.webp"></source> <img src="/assets/img/weaponDmg2.PNG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="img" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>As we can see there are a lot of properties beyond the weapon damage, but they need to be reversed.</p> <p>3) <strong>HARD</strong> (Recoil function with IDA):</p> <p>From the process showed for the weapon damage, We see that We found recoil too (after some testing).</p> <p>Using that offset, on Cheat Engine we will find out what accesses to that address, go to disassembler, and retrieve the address:</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/recoil1.PNG-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/recoil1.PNG-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/recoil1.PNG-1400.webp"></source> <img src="/assets/img/recoil1.PNG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="img" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>Now It’s time for IDA.</p> <p>Going to that address and Decompiling the assembly instructions We get this:</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/idarecoil1.PNG-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/idarecoil1.PNG-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/idarecoil1.PNG-1400.webp"></source> <img src="/assets/img/idarecoil1.PNG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="img" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>Confusing right? It’s not easy but with some practice everything will make sense.</p> <p>After reversing it (I’m not gonna explain the whole process because I’m not the one that should teach you these things):</p> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/idarecoil2.PNG-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/idarecoil2.PNG-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/idarecoil2.PNG-1400.webp"></source> <img src="/assets/img/idarecoil2.PNG" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="img" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <p>(IDA fucked up the indentation)</p> <p>As we can see, there is a multilevel pointers calculation to go to the recoil offset, now We can conclude that the instruction where we need to operate on is this one.</p> <p>To implement no recoil, We can just simply nop this instruction. (<strong>nopping</strong> is pratically “hiding” that particular instruction without impacting the whole program, and that instruction will never be executed).</p> <p>I hope that you liked this little post :)</p> <p><a href="https://www.youtube.com/watch?v=huTILhprxls" rel="external nofollow noopener" target="_blank">video</a></p> </div> </article> </div> </div> <footer class="sticky-bottom mt-5"> <div class="container"> © Copyright 2024 Umberto Breglia. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>